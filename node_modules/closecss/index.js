'use strict';
var postcss = require('postcss');
var random = require('./Randomizer.js');
var closecss = postcss.plugin('closecss', function (opts){
  return function (css) {
    opts = opts || {};
    css.walkRules(function (rule){
      css.walkDecls(function (decl, i) {

        if (decl.value.indexOf('somewhat(') > -1 ){
          var value = decl.value;
          var regex = /["']([^)]+)["']/g;
          var val = regex.exec(value)[1];
          decl.value = random.color(val);
        }

      });
    });
  };
});

var processor = postcss([closecss]);

module.exports = processor;
